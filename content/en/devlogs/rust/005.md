+++
author = "Kendry"
title = "Learning Rust - Concurrency"
date = "2023-04-12"
description = "Closures, concurrency and smart pointers."
tags = [
    "devlog", "rust"
]
toc = false
+++

## Closures

Closures are anonymous functions that work just like in javascript.
Closures can capture its environment and have their own scope.
They can also be anotated like this:  
`let add_one_v2 = |x: u32| -> u32 { x + 1 };`  
These are very useful when combining them with functions that operate
over a list of values just like `map` or `filter`, a good example could be:

![a function returning the most stocked value](/posts/rust/ex5-1.png)

In this function we can see how to use a closure to get a value from
the `user_preference` struct. The `unwrap_or_else` tells Rust that
we want the value on the `user_preference` argument if it's not
Nil, in case it is, run `x` function, in this case a closure that
uses `self` to get the most stocked item.

## Iterators

Iterators in Rust are lazy, they don't do anything unless consumed
by the user. Iterators take ownership of the values they are iterating
on, for example a foor l

A _consuming adaptor_ is a method that calls the `next` method
of an iterator, because calling it uses up the iterator.
_Iterator adaptors_ are methods that don't consume the iterator.
Instead, they produce different iterators. An example of this is
`map`. `map` in Rust returns a new iterator.

We can use `collect()` to get a collection back from an iterator,
this is useful when using an _iterator adaptor_ since what you
get back from them are other iterators after your closure has
done the job. An example of this could be:

![function that iterates over an integer vector and adds one](/posts/rust/ex5-2.png)

This function takes a reference to an integer vector, turns it into
an iterator, maps the values to add one into a new iterator and then
calls the collect method to send a collection once again. This is not
necessarily the best function to make since this could also be done
in place.

## Publishing and Workspaces
